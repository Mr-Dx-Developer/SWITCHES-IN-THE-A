import{ae as L,af as D,at as K,am as z,e as E,s as H,f as I,i as q,g as V,y as S,h as C,Q as G,P as T,k as J,j as Q,l as M,q as W,G as v,A as X,B as Y,C as Z,D as $,E as ee,F as _,_ as te,o as P,b as w,w as g,I as ne,u as y,N as j,J as k,t as R,K as oe}from"./index-1c6b3dd3.js";import{c as se}from"./utils-96123b18.js";import{c as le,N as ae,m as B}from"./SelectMenu-49f9a701.js";import{h as ie}from"./FocusDetector-bd94bb6c.js";import"./VirtualList-e7fe5725.js";import"./Empty-168292b7.js";import"./use-locale-119c58a2.js";function re(e){return t=>{t?e.value=t.$el:e.value=null}}function ce(e){const{boxShadow2:t}=e;return{menuBoxShadow:t}}const ue=L({name:"Popselect",common:D,peers:{Popover:K,InternalSelectMenu:z},self:ce}),U=ue,F=E("n-popselect"),de=H("popselect-menu",`
 box-shadow: var(--n-menu-box-shadow);
`),x={multiple:Boolean,value:{type:[String,Number,Array],default:null},cancelable:Boolean,options:{type:Array,default:()=>[]},size:{type:String,default:"medium"},scrollable:Boolean,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onMouseenter:Function,onMouseleave:Function,renderLabel:Function,showCheckmark:{type:Boolean,default:void 0},nodeProps:Function,virtualScroll:Boolean,onChange:[Function,Array]},A=W(x),pe=I({name:"PopselectPanel",props:x,setup(e){const t=q(F),{mergedClsPrefixRef:n,inlineThemeDisabled:s}=V(e),c=S("Popselect","-pop-select",de,U,t.props,n),a=C(()=>le(e.options,se("value","children")));function i(o,f){const{onUpdateValue:u,"onUpdate:value":p,onChange:h}=e;u&&v(u,o,f),p&&v(p,o,f),h&&v(h,o,f)}function l(o){d(o.key)}function r(o){ie(o,"action")||o.preventDefault()}function d(o){const{value:{getNode:f}}=a;if(e.multiple)if(Array.isArray(e.value)){const u=[],p=[];let h=!0;e.value.forEach(O=>{if(O===o){h=!1;return}const b=f(O);b&&(u.push(b.key),p.push(b.rawNode))}),h&&(u.push(o),p.push(f(o).rawNode)),i(u,p)}else{const u=f(o);u&&i([o],[u.rawNode])}else if(e.value===o&&e.cancelable)i(null,null);else{const u=f(o);u&&i(o,u.rawNode);const{"onUpdate:show":p,onUpdateShow:h}=t.props;p&&v(p,!1),h&&v(h,!1),t.setShow(!1)}T(()=>{t.syncPosition()})}G(J(e,"options"),()=>{T(()=>{t.syncPosition()})});const N=C(()=>{const{self:{menuBoxShadow:o}}=c.value;return{"--n-menu-box-shadow":o}}),m=s?Q("select",void 0,N,t.props):void 0;return{mergedTheme:t.mergedThemeRef,mergedClsPrefix:n,treeMate:a,handleToggle:l,handleMenuMousedown:r,cssVars:s?void 0:N,themeClass:m==null?void 0:m.themeClass,onRender:m==null?void 0:m.onRender}},render(){var e;return(e=this.onRender)===null||e===void 0||e.call(this),M(ae,{clsPrefix:this.mergedClsPrefix,focusable:!0,nodeProps:this.nodeProps,class:[`${this.mergedClsPrefix}-popselect-menu`,this.themeClass],style:this.cssVars,theme:this.mergedTheme.peers.InternalSelectMenu,themeOverrides:this.mergedTheme.peerOverrides.InternalSelectMenu,multiple:this.multiple,treeMate:this.treeMate,size:this.size,value:this.value,virtualScroll:this.virtualScroll,scrollable:this.scrollable,renderLabel:this.renderLabel,onToggle:this.handleToggle,onMouseenter:this.onMouseenter,onMouseleave:this.onMouseenter,onMousedown:this.handleMenuMousedown,showCheckmark:this.showCheckmark},{action:()=>{var t,n;return((n=(t=this.$slots).action)===null||n===void 0?void 0:n.call(t))||[]},empty:()=>{var t,n;return((n=(t=this.$slots).empty)===null||n===void 0?void 0:n.call(t))||[]}})}}),fe=Object.assign(Object.assign(Object.assign(Object.assign({},S.props),$(_,["showArrow","arrow"])),{placement:Object.assign(Object.assign({},_.placement),{default:"bottom"}),trigger:{type:String,default:"hover"}}),x),he=I({name:"Popselect",props:fe,inheritAttrs:!1,__popover__:!0,setup(e){const{mergedClsPrefixRef:t}=V(e),n=S("Popselect","-popselect",void 0,U,e,t),s=X(null);function c(){var l;(l=s.value)===null||l===void 0||l.syncPosition()}function a(l){var r;(r=s.value)===null||r===void 0||r.setShow(l)}return Y(F,{props:e,mergedThemeRef:n,syncPosition:c,setShow:a}),Object.assign(Object.assign({},{syncPosition:c,setShow:a}),{popoverInstRef:s,mergedTheme:n})},render(){const{mergedTheme:e}=this,t={theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:{padding:"0"},ref:"popoverInstRef",internalRenderBody:(n,s,c,a,i)=>{const{$attrs:l}=this;return M(pe,Object.assign({},l,{class:[l.class,n],style:[l.style,c]},Z(this.$props,A),{ref:re(s),onMouseenter:B([a,l.onMouseenter]),onMouseleave:B([i,l.onMouseleave])}),{action:()=>{var r,d;return(d=(r=this.$slots).action)===null||d===void 0?void 0:d.call(r)},empty:()=>{var r,d;return(d=(r=this.$slots).empty)===null||d===void 0?void 0:d.call(r)}})}};return M(ee,Object.assign({},$(this.$props,A),t,{internalDeactivateImmediately:!0}),{trigger:()=>{var n,s;return(s=(n=this.$slots).default)===null||s===void 0?void 0:s.call(n)}})}});const me={__name:"PopSelect",props:{field:Object},setup(e){const t=e;function n(s){const c=t.field.options;if(typeof s=="string"){const a=c.find(i=>i.value===s);return a?a.label:void 0}else if(typeof s=="object")return s.map(i=>{const l=c.find(r=>r.value===i);return l?l.label:void 0}).filter(i=>i!==void 0)}return(s,c)=>(P(),w(y(oe),null,{default:g(()=>[ne(y(he),{value:e.field.value,"onUpdate:value":c[0]||(c[0]=a=>e.field.value=a),options:e.field.options,multiple:e.field.multiple},{default:g(()=>[e.field.multiple?(P(),w(y(j),{key:1},{default:g(()=>[k(R(Array.isArray(e.field.value)&&e.field.value.length?n(e.field.value):"Nothing"),1)]),_:1})):(P(),w(y(j),{key:0},{default:g(()=>[k(R(e.field.value&&n(e.field.value)||e.field.label),1)]),_:1}))]),_:1},8,["value","options","multiple"])]),_:1}))}},Se=te(me,[["__scopeId","data-v-4a3d3fb4"]]);export{Se as default};
