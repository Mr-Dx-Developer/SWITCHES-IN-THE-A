import{r as n,a as c,j as e,F as N}from"./jsx-runtime-f40812bf.js";import{f as d,l as C,C as P,b as a,L as s,c as x,e as O,d as T,S as R}from"./Phone-6f7ce284.js";import{u as m,a0 as j,s as D}from"./index.esm-3d32a72b.js";import{C as X}from"./Check-0b024d45.js";import{N as w}from"./Numpad-cc7ba39c.js";import"./number-28525126.js";const u=D(0);function M(){const r=m(a.Settings),i=m(a.Setup.Stage),I=n.useRef(null),[p,g]=n.useState([]),[S,b]=n.useState(null),[k,U]=n.useState(!1),[o,y]=n.useState([]),f=m(u),v=m(R.Visible),A=n.useRef(!1),[L,E]=n.useState("show");n.useEffect(()=>{d("getLocales").then(t=>{t&&y(t)})},[r]),n.useEffect(()=>{if(!o||o.length===0||i!==0||!v)return;let t=setInterval(()=>{E("hide"),setTimeout(()=>{let l=F(u.value);u.set(l),u.value},1500),setTimeout(()=>{E("show")},1520)},4e3);return()=>{clearInterval(t)}},[o,i,v]),n.useEffect(()=>{var t;C(((t=o[f])==null?void 0:t.locale)??"en")},[f]);const F=t=>o[t+1]?t+1:0,_=t=>{if(t=="backspace")g(l=>l.slice(0,-1));else{const l=[...p,t];g([...p,t]),l.length>3&&(T("info","Attempting to setpin"),d("Security",{action:"setPin",pin:l.join(""),oldPin:S}).then(h=>{if(!h)return T("error","Failed to set pin "+h);a.Settings.patch({security:{...a.Settings.value.security,pinCode:!0}}),b(l.join("")),g([]),a.Setup.Stage.set(a.Setup.Stage.value+1)}))}};return n.useEffect(()=>{i===0||i===5?P.IndicatorVisible.set(!0):P.IndicatorVisible.set(!1)},[i]),c("div",{className:`setupContainer ${L}`,children:[e("div",{className:"header",children:i!==0&&e(j,{onClick:()=>{a.Setup.Stage.set(a.Setup.Stage.value-1)}})}),i===0&&c(N,{children:[e("div",{className:"titleContainer",children:s("SETUP.HELLO")}),e("div",{className:"footer",children:s("SETUP.NEXT")})]}),i===1&&c("div",{className:"chooseLanguage",children:[e("i",{className:"far fa-globe globe"}),e("div",{className:"languages",children:o.map(t=>c("div",{className:"item",onClick:()=>{a.Setup.Stage.set(a.Setup.Stage.value+1),A.current=!0,a.Settings.patch({locale:t.locale});let l=o.findIndex(h=>h.locale===t.locale);C(t.locale).then(()=>{u.set(l)})},children:[e("div",{className:"label",children:t.name}),e("i",{className:"fas fa-chevron-right"})]},t.locale))})]}),i===2&&c("div",{className:"passcode slideIn",children:[e("i",{className:"fas fa-lock lock"}),e("div",{className:"title",children:s("SETUP.CREATE_PASSCODE")}),e("div",{className:"subtitle",children:s("SETUP.CREATE_PASSCODE_TEXT")}),e(x,{pin:p,Ref:I,dark:!0}),e("div",{className:"highlight",onClick:()=>{S&&d("Security",{action:"removePin"}),a.Setup.Stage.set(a.Setup.Stage.value+2),a.Settings.patch({security:{...a.Settings.value.security,pinCode:!1}})},children:s("SETUP.SKIP")}),e("div",{className:"buttons",children:e(w,{cb:_})})]}),i===3&&c("div",{className:"faceId slideIn",children:[e("img",{className:"faceid",src:"./assets/img/icons/FaceId.png"}),e("div",{className:"title",children:s("SETUP.FACE_ID_SETUP")}),e("div",{className:"subtitle",children:s("SETUP.FACE_ID_TEXT")}),e("div",{className:"button",onClick:()=>{d("Security",{action:"setFaceId",pin:S}).then(t=>{t&&(a.Settings.patch({security:{...a.Settings.value.security,faceId:!0}}),U(!0),a.Setup.Stage.set(a.Setup.Stage.value+1))})},children:s("SETUP.ENABLE_FACE_ID")}),e("div",{className:"highlight",onClick:()=>{k&&d("Security",{action:"removeFaceId",pin:S}),a.Setup.Stage.set(a.Setup.Stage.value+1),a.Settings.patch({security:{...a.Settings.value.security,faceId:!1}})},children:s("SETUP.SKIP")})]}),i===4&&c("div",{className:"appearance slideIn",children:[e("div",{className:"title",children:s("SETUP.APPEARANCE")}),e("div",{className:"subtitle",children:s("SETUP.APPEARANCE_TEXT")}),e("div",{className:"modes",children:["light","dark"].map((t,l)=>c("div",{className:"mode",onClick:()=>{a.Settings.patch({display:{...a.Settings.value.display,theme:t}})},children:[e("img",{src:`./assets/img/${t}-mode-placeholder.png`,alt:"Theme"}),e("div",{className:"mode-text",children:O(t)}),e(X,{checked:r.display.theme===t})]},l))}),e("div",{className:"button",onClick:()=>a.Setup.Stage.set(a.Setup.Stage.value+1),children:s("SETUP.CONTINUE")})]}),i===5&&c(N,{children:[c("div",{className:"titleContainer small",children:[s("SETUP.WELCOME_TO")," ",e(K,{})]}),e("div",{className:"footer",children:s("SETUP.CLICK")})]})]})}const K=()=>{const r="abcdefghijklmnopqrstuvwxyz".split("");return c("span",{children:[r[11].toUpperCase(),r[1].toUpperCase()," ",r[15].toUpperCase(),r[7],r[14],r[13],r[4]]})};export{M as default};
