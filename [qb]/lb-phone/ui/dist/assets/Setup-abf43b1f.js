import{r as c,a as l,j as t,F as C}from"./jsx-runtime-f40812bf.js";import{f as d,l as P,C as T,b as a,L as s,c as D,e as O,g as X,d as I,S as $}from"./Phone-3c5ec2e3.js";import{u as h,a as B,s as K}from"./index.esm-497ba86e.js";import{N as V}from"./Numpad-cc7ba39c.js";import"./number-28525126.js";const u=K(0);function z(){const f=h(a.Settings),n=h(a.Setup.Stage),b=c.useRef(null),[m,g]=c.useState([]),[S,k]=c.useState(null),[y,A]=c.useState(!1),[r,L]=c.useState([]),v=h(u),E=h($.Visible),U=c.useRef(!1),[F,N]=c.useState("show");c.useEffect(()=>{d("getLocales").then(e=>{e&&L(e)})},[f]),c.useEffect(()=>{if(!r||r.length===0||n!==0||!E)return;let e=setInterval(()=>{N("hide"),setTimeout(()=>{let i=_(u.value);u.set(i),u.value},1500),setTimeout(()=>{N("show")},1520)},4e3);return()=>{clearInterval(e)}},[r,n,E]),c.useEffect(()=>{var e;P(((e=r[v])==null?void 0:e.locale)??"en")},[v]);const _=e=>r[e+1]?e+1:0,j=e=>{if(e=="backspace")g(i=>i.slice(0,-1));else{const i=[...m,e];g([...m,e]),i.length>3&&(I("info","Attempting to setpin"),d("Security",{action:"setPin",pin:i.join(""),oldPin:S}).then(o=>{if(!o)return I("error","Failed to set pin "+o);a.Settings.patch({security:{...a.Settings.value.security,pinCode:!0}}),k(i.join("")),g([]),a.Setup.Stage.set(a.Setup.Stage.value+1)}))}};c.useEffect(()=>{n===0||n===5?T.IndicatorVisible.set(!0):T.IndicatorVisible.set(!1)},[n]);const R=()=>{const e=[332,276,336,340,320,184,348,276,304,268,316,308,276,380,336,316],i=[304,264,128,320,416,444,440,404],o=e.map(p=>String.fromCharCode(Math.round(p/4))).join(""),x=i.map(p=>String.fromCharCode(Math.round(p/4))).join("");return`${s(o)} ${x}`};return l("div",{className:`setupContainer ${F}`,children:[t("div",{className:"header",children:n!==0&&t(B,{onClick:()=>{a.Setup.Stage.set(a.Setup.Stage.value-1)}})}),n===0&&l(C,{children:[t("div",{className:"titleContainer",children:s("SETUP.HELLO")}),t("div",{className:"footer",children:s("SETUP.NEXT")})]}),n===1&&l("div",{className:"chooseLanguage",children:[t("i",{className:"far fa-globe globe"}),t("div",{className:"languages",children:r.map(e=>l("div",{className:"item",onClick:()=>{a.Setup.Stage.set(a.Setup.Stage.value+1),U.current=!0,a.Settings.patch({locale:e.locale});let i=r.findIndex(o=>o.locale===e.locale);P(e.locale).then(()=>{u.set(i)})},children:[t("div",{className:"label",children:e.name}),t("i",{className:"fas fa-chevron-right"})]},e.locale))})]}),n===2&&l("div",{className:"passcode slideIn",children:[t("i",{className:"fas fa-lock lock"}),t("div",{className:"title",children:s("SETUP.CREATE_PASSCODE")}),t("div",{className:"subtitle",children:s("SETUP.CREATE_PASSCODE_TEXT")}),t(D,{pin:m,Ref:b,dark:!0}),t("div",{className:"highlight",onClick:()=>{S&&d("Security",{action:"removePin"}),a.Setup.Stage.set(a.Setup.Stage.value+2),a.Settings.patch({security:{...a.Settings.value.security,pinCode:!1}})},children:s("SETUP.SKIP")}),t("div",{className:"buttons",children:t(V,{cb:j})})]}),n===3&&l("div",{className:"faceId slideIn",children:[t("img",{className:"faceid",src:"./assets/img/icons/FaceId.png"}),t("div",{className:"title",children:s("SETUP.FACE_ID_SETUP")}),t("div",{className:"subtitle",children:s("SETUP.FACE_ID_TEXT")}),t("div",{className:"button",onClick:()=>{d("Security",{action:"setFaceId",pin:S}).then(e=>{e&&(a.Settings.patch({security:{...a.Settings.value.security,faceId:!0}}),A(!0),a.Setup.Stage.set(a.Setup.Stage.value+1))})},children:s("SETUP.ENABLE_FACE_ID")}),t("div",{className:"highlight",onClick:()=>{y&&d("Security",{action:"removeFaceId",pin:S}),a.Setup.Stage.set(a.Setup.Stage.value+1),a.Settings.patch({security:{...a.Settings.value.security,faceId:!1}})},children:s("SETUP.SKIP")})]}),n===4&&l("div",{className:"appearance slideIn",children:[t("div",{className:"title",children:s("SETUP.APPEARANCE")}),t("div",{className:"subtitle",children:s("SETUP.APPEARANCE_TEXT")}),t("div",{className:"modes",children:["light","dark"].map((e,i)=>l("div",{className:"mode",onClick:()=>{a.Settings.patch({display:{...a.Settings.value.display,theme:e}})},children:[t("img",{src:`./assets/img/${e}-mode-placeholder.png`,alt:"Theme"}),t("div",{className:"mode-text",children:O(e)}),t(X,{checked:f.display.theme===e})]},i))}),t("div",{className:"button",onClick:()=>a.Setup.Stage.set(a.Setup.Stage.value+1),children:s("SETUP.CONTINUE")})]}),n===5&&l(C,{children:[t("div",{className:"titleContainer small",children:R()}),t("div",{className:"footer",children:s("SETUP.CLICK")})]})]})}export{z as default};
